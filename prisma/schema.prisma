// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
}

model User {
    id          String   @id @default(cuid())
    clerkUserId String   @unique
    email       String   @unique
    name        String?
    imageUrl    String?
    industry    String?
    title       String?
    bio         String?
    experience  Int?
    skills      String[]
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt

    // Relations
    industryInsight IndustryInsight? @relation(fields: [industry], references: [industry], onDelete: SetNull, onUpdate: Cascade)
    assessments     Assessment[]
    resume          Resume?          @relation(fields: [resumeId], references: [id])
    coverLetters    CoverLetter[]
    resumeId        String?
}

model Assessment {
    id         String   @id @default(cuid())
    userId     String
    question   String
    answer     String
    userAnswer String
    score      Float
    category   String
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt
    user       User     @relation(fields: [userId], references: [id])

    @@index([userId])
}

model Resume {
    id        String   @id @default(cuid())
    userId    String   @unique
    content   String
    atsScore  Float?
    feedback  String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    users     User[]
}

model CoverLetter {
    id             String   @id @default(cuid())
    userId         String
    content        String
    jobDescription String?
    companyName    String
    jobTitle       String
    status         String   @default("draft")
    createdAt      DateTime @default(now())
    updatedAt      DateTime @updatedAt
    user           User     @relation(fields: [userId], references: [id])

    @@index([userId])
}

// Combined Industry Trends and Salary Insights
model IndustryInsight {
    id                String   @id @default(cuid())
    industry          String   @unique
    salaryRanges      Json[]
    growthRate        Float
    demandLevel       String
    topSkills         String[]
    marketOutlook     String
    keyTrends         String[]
    recommendedSkills String[]
    lastUpdated       DateTime @default(now())
    nextUpdate        DateTime
    createdAt         DateTime @default(now())
    updatedAt         DateTime @updatedAt

    // Relations
    users User[]

    @@index([industry])
}
